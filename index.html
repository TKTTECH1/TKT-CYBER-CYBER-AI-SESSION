<!DOCTYPE html>
<html>
<head>
  <title>TKT-CYBER-XMD-V3 DEPLOY</title>
  <style>
    body { font-family: Arial; text-align: center; padding: 20px; }
    input, button { padding: 10px; margin: 10px; width: 80%; }
  </style>
</head>
<body>
  <h1>üöÄ TKT-CYBER-XMD-V3 BOT DEPLOY</h1>
  
  <!-- Step 1: GitHub Username -->
  <div id="step1">
    <p>1. Apna GitHub username daalo:</p>
    <input type="text" id="githubUsername" placeholder="GitHubUsername">
  </div>

  <!-- Step 2: SESSION_ID (Hidden Initially) -->
  <div id="step2" style="display:none;">
    <p>2. Isa  SESSION_ID yako here :</p>
    <input type="text" id="sessionId" placeholder="(TKT-CYBER~)SFMyNTY...">
  </div>

  <button id="submitBtn">SUBMIT</button>
  <div id="result"></div>

  <script>
    document.getElementById("submitBtn").addEventListener("click", async () => {
      const username = document.getElementById("githubUsername").value;
      const sessionId = document.getElementById("sessionId").value;

      // Step 1: Verify Fork
      if (!sessionId) {
        const res = await fetch(`https://api.github.com/repos/${username}/TKT-CYBER-XMD-V3`);
        if (res.ok) {
          document.getElementById("step1").style.display = "none";
          document.getElementById("step2").style.display = "block";
        } else {
          alert("Pehle fork karo: https://github.com/tkttech/TKT-CYBER-XMD-V3/fork");
        }
        return;
      }

      // Step 2: Deploy
      const deployRes = await fetch("/deploy", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ github_username: username, session_id: sessionId })
      });
      const data = await deployRes.json();
      
      document.getElementById("result").innerHTML = data.success 
        ? `‚úÖ Bot Ready: <a href="${data.url}" target="_blank">${data.url}</a>` 
        : `‚ùå Error: ${data.error}`;
    });
  </script>
</body>
</html>
